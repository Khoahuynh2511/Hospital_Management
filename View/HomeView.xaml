<UserControl x:Class="LTTQ_DoAn.View.HomeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:LTTQ_DoAn.View"
             xmlns:viewmodel="clr-namespace:LTTQ_DoAn.ViewModel"
             mc:Ignorable="d" 
              xmlns:fa="http://schemas.awesome.incremented/wpf/xaml/fontawesome.sharp"
             Background="Transparent"
             xmlns:materialdesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             d:DesignHeight="644" d:DesignWidth="1049"
             FontFamily="Poppins">
    <UserControl.DataContext>
        <viewmodel:HomeViewModel></viewmodel:HomeViewModel>
    </UserControl.DataContext>
    <Border 
        CornerRadius="20"
        Background="White">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="50"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!--Quick Stats Cards-->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="10 15 10 5">
                <!--Today Patients-->
                <Border Background="{StaticResource cardPatientBg}" CornerRadius="10" Padding="15" Margin="8" MinWidth="180">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.2"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="BỆNH NHÂN HÔM NAY" FontWeight="Bold" FontSize="11" Foreground="#1565C0"/>
                        <TextBlock Text="{Binding TodayPatientCount}" FontSize="28" FontWeight="Bold" Foreground="#1565C0" Margin="0 5 0 0"/>
                    </StackPanel>
                </Border>
                
                <!--Today Appointments-->
                <Border Background="{StaticResource cardQueueBg}" CornerRadius="10" Padding="15" Margin="8" MinWidth="180">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.2"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="LỊCH HẸN HÔM NAY" FontWeight="Bold" FontSize="11" Foreground="#E65100"/>
                        <TextBlock Text="{Binding TodayAppointmentCount}" FontSize="28" FontWeight="Bold" Foreground="#E65100" Margin="0 5 0 0"/>
                    </StackPanel>
                </Border>
                
                <!--Today Revenue-->
                <Border Background="{StaticResource cardRevenueBg}" CornerRadius="10" Padding="15" Margin="8" MinWidth="180">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.2"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="DOANH THU HÔM NAY" FontWeight="Bold" FontSize="11" Foreground="#2E7D32"/>
                        <TextBlock Text="{Binding TodayRevenueFormatted}" FontSize="18" FontWeight="Bold" Foreground="#2E7D32" Margin="0 5 0 0"/>
                    </StackPanel>
                </Border>
                
                <!--Low Stock Medicines-->
                <Border Background="{StaticResource cardAlertBg}" CornerRadius="10" Padding="15" Margin="8" MinWidth="180">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.2"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="THUỐC SẮP HẾT" FontWeight="Bold" FontSize="11" Foreground="#C62828"/>
                        <TextBlock Text="{Binding LowStockMedicineCount}" FontSize="28" FontWeight="Bold" Foreground="#C62828" Margin="0 5 0 0"/>
                    </StackPanel>
                </Border>
            </StackPanel>
            
            <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center"
                        Margin="50 0 0 0">
                <DatePicker
                SelectedDate="{Binding Chart_startdate, Mode=TwoWay}"
                Width="150"
                Height="40"
                FontSize="15"
                materialdesign:HintAssist.Hint="Từ ngày"
                materialdesign:HintAssist.Background="{StaticResource btnActivedGround}"
                Style="{StaticResource MaterialDesignFloatingHintDatePicker}"/>

                <DatePicker
                 SelectedDate="{Binding Chart_enddate, Mode=TwoWay}"
                 Width="150"
                Margin="100 0 0 0"
                 Height="40"
                 FontSize="15"
                 materialdesign:HintAssist.Hint="Đến ngày"
                 materialdesign:HintAssist.Background="{StaticResource btnActivedGround}"
                 Style="{StaticResource MaterialDesignFloatingHintDatePicker}"/>
            </StackPanel>
            <TabControl Grid.Row="2"
                materialDesign:ColorZoneAssist.Foreground="{StaticResource btnActivedText}"
                        materialDesign:ColorZoneAssist.Mode="Custom">
                <TabItem Header="Bệnh nhân"
                         >
                    <Grid Background="white"
                          >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="60"/>
                        </Grid.RowDefinitions>
                        <!--Biểu đồ -->
                        <Grid Grid.Row="0">
                            <lvc:CartesianChart Series="{Binding Victim_series_collections}" x:Name="VictimChart">
                                <!--
                                <lvc:CartesianChart.Series>
                                    <lvc:ColumnSeries Title="Số lượng bệnh nhân" Values="{Binding Victim_series_collections}" FontSize="15"/>
                                </lvc:CartesianChart.Series>
                                -->
                                <lvc:CartesianChart.AxisX>
                                    <lvc:Axis Title="Thời gian" Labels="{Binding VictimTimeLabels}" FontSize="15"/>
                                </lvc:CartesianChart.AxisX>
                                <lvc:CartesianChart.AxisY>
                                    <lvc:Axis Title="Số lượng bệnh nhân" FontSize="15"
                                              LabelFormatter="{Binding YFormatter}"
                                MinValue="0"/>
                                </lvc:CartesianChart.AxisY>
                            </lvc:CartesianChart>
                        </Grid>
                        <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="50 0 0 0">
                            <TextBlock Text="Tổng số bệnh nhân: "
                                       FontSize="25"
                                       FontWeight="Bold"/>
                            <!--Thêm số lượng bệnh nhân trong thời gian được chọn vào đây-->
                            <TextBlock Text="{Binding Victim_count}"
                               FontSize="25"
                               FontWeight="Bold"/>
                            <DockPanel Width="730">
                                <Button 
                            HorizontalAlignment="Right"
                            Style="{StaticResource BtnUserControl}" Click="Victim_Button_Click"
                            
                            >
                                    <TextBlock
                                    Style="{StaticResource UserControlText}"
                                    Text="Xuất biểu đồ"
                                    >
                                    </TextBlock>
                                </Button>
                            </DockPanel>

                        </StackPanel>

                    </Grid>
                </TabItem>
                <TabItem Header="Bệnh án">
                    <Grid Background="white">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="60"/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <lvc:CartesianChart Series="{Binding Benhan_collections}" x:Name="BenhanChart">
                                <lvc:CartesianChart.AxisX>
                                    <lvc:Axis Title="Thời gian" Labels="{Binding BenhanTimeLabels}" FontSize="15"/>
                                </lvc:CartesianChart.AxisX>
                                <lvc:CartesianChart.AxisY>
                                    <lvc:Axis Title="Số lượng bệnh án" FontSize="15"
                                              LabelFormatter="{Binding YFormatter}"
                                              MinValue="0"/>
                                </lvc:CartesianChart.AxisY>
                            </lvc:CartesianChart>
                        </Grid>
                        <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="50 0 0 0">
                            <TextBlock Text="Tổng số bệnh án: "
                                       FontSize="25"
                                       FontWeight="Bold"/>
                            <TextBlock Text="{Binding Benhan_count}"
                               FontSize="25"
                               FontWeight="Bold"/>
                            <DockPanel Width="730">
                                <Button 
                            HorizontalAlignment="Right"
                            Style="{StaticResource BtnUserControl}" Click="Benhan_Button_Click">
                                    <TextBlock
                                    Style="{StaticResource UserControlText}"
                                    Text="Xuất biểu đồ"/>
                                </Button>
                            </DockPanel>
                        </StackPanel>
                    </Grid>
                </TabItem>
                <TabItem Header="Đơn thuốc">
                    <Grid Background="white">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="60"/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <lvc:CartesianChart Series="{Binding Donthuoc_collections}" x:Name="DonthuocChart">
                                <lvc:CartesianChart.AxisX>
                                    <lvc:Axis Title="Thời gian" Labels="{Binding DonthuocTimeLabels}" FontSize="15"/>
                                </lvc:CartesianChart.AxisX>
                                <lvc:CartesianChart.AxisY>
                                    <lvc:Axis Title="Số lượng đơn thuốc" FontSize="15"
                                              LabelFormatter="{Binding YFormatter}"
                                              MinValue="0"/>
                                </lvc:CartesianChart.AxisY>
                            </lvc:CartesianChart>
                        </Grid>
                        <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="50 0 0 0">
                            <TextBlock Text="Tổng số đơn thuốc: "
                                       FontSize="25"
                                       FontWeight="Bold"/>
                            <TextBlock Text="{Binding Donthuoc_count}"
                               FontSize="25"
                               FontWeight="Bold"/>
                            <DockPanel Width="730">
                                <Button 
                            HorizontalAlignment="Right"
                            Style="{StaticResource BtnUserControl}" Click="Donthuoc_Button_Click">
                                    <TextBlock
                                    Style="{StaticResource UserControlText}"
                                    Text="Xuất biểu đồ"/>
                                </Button>
                            </DockPanel>
                        </StackPanel>
                    </Grid>
                </TabItem>
                <TabItem Header="Thuốc">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="60"/>
                        </Grid.RowDefinitions>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="250"/>
                            </Grid.ColumnDefinitions>
                            <lvc:CartesianChart Series="{Binding Medicine_collections}" x:Name="MedicineChart">
                                <lvc:CartesianChart.AxisX>
                                    <lvc:Axis Title="Thời gian" Labels="{Binding MedicineTimeLabels}" FontSize="15"/>
                                </lvc:CartesianChart.AxisX>
                                <lvc:CartesianChart.AxisY>
                                    <lvc:Axis Title="Số lượng thuốc bán ra" FontSize="15"
                                              LabelFormatter="{Binding YFormatter}"
                                              MinValue="0"/>
                                </lvc:CartesianChart.AxisY>
                            </lvc:CartesianChart>
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="Thuốc bán chạy:"
                                           FontWeight="Bold"
                                           FontSize="20"
                                           Foreground="{StaticResource btnActivedText}"
                                           Margin="0 30 0 10"/>
                                <ScrollViewer VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Disabled"
                                      MaxHeight="450">
                                    <ListView ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                            ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                            BorderBrush="Transparent" Background="White"
                                            HorizontalAlignment="Stretch"
                                            PreviewMouseWheel="ListView_PreviewMouseWheel"
                                            ItemsSource="{Binding ListThuocBanChay}">
                                        <ListView.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel IsItemsHost="True" Orientation="Vertical" />
                                            </ItemsPanelTemplate>
                                        </ListView.ItemsPanel>
                                        <ListView.ItemContainerStyle>
                                            <Style TargetType="ListViewItem">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                            </Style>
                                        </ListView.ItemContainerStyle>
                                        <ListView.ItemTemplate>
                                            <DataTemplate>
                                                <Border BorderBrush="{StaticResource btnActivedText}"
                                                    BorderThickness="2 0 0 0"
                                                    Margin="0 20 0 0">
                                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Left"
                                                        Margin="10 0 0 0">
                                                        <TextBlock Text="{Binding Ten}"
                                                        Foreground="#3f3f3f"
                                                        FontSize="18"
                                                        FontWeight="Medium"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Center"/>
                                                        <TextBlock Text="Số lượng: "
                                                        Foreground="#3f3f3f"
                                                        FontSize="14"
                                                        HorizontalAlignment="Left"/>
                                                        <TextBlock Text="{Binding Soluong}"
                                                        Foreground="#3f3f3f"
                                                        FontSize="16"
                                                        FontWeight="Medium"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Center"/>
                                                        <TextBlock Text="Doanh thu: "
                                                        Foreground="#3f3f3f"
                                                        FontSize="14"
                                                        HorizontalAlignment="Left"/>
                                                        <TextBlock Text="{Binding Doanhthu}"
                                                        Foreground="#3f3f3f"
                                                        FontSize="16"
                                                        FontWeight="Medium"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                </ScrollViewer>
                            </StackPanel>
                        </Grid>
                        <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="50 0 0 0">
                            <TextBlock Text="Tổng số lượng thuốc bán ra: "
                                        FontSize="25"
                                        FontWeight="Bold"/>
                            <TextBlock Text="{Binding Medicine_sold_count}"
                                        FontSize="25"
                                        FontWeight="Bold"/>
                            <DockPanel Width="600">
                                <Button 
                                HorizontalAlignment="Right"
                                Style="{StaticResource BtnUserControl}" Click="Medicine_Button_Click">
                                    <TextBlock
                                    Style="{StaticResource UserControlText}"
                                    Text="Xuất biểu đồ"/>
                                </Button>
                            </DockPanel>
                        </StackPanel>
                    </Grid>
                </TabItem>
                <TabItem Header="Doanh thu">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="60"/>
                        </Grid.RowDefinitions>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="250"/>
                            </Grid.ColumnDefinitions>
                            <!--Biểu đồ -->
                            <lvc:CartesianChart Series="{Binding Service_collections}" x:Name="MoneyChart">
                                <!-- 
                                <lvc:CartesianChart.Series>
                                    <lvc:ColumnSeries Title="Doanh thu"/>
                                </lvc:CartesianChart.Series>
                                -->
                                <lvc:CartesianChart.AxisX>
                                    <lvc:Axis Title="Thời gian" Labels="{Binding ServiceTimeLabels}" FontSize="15"/>
                                </lvc:CartesianChart.AxisX>
                                <lvc:CartesianChart.AxisY>
                                    <lvc:Axis
                                          LabelFormatter="{Binding VNDFormatter}"
                                          MinValue="0"/>
                                </lvc:CartesianChart.AxisY>
                            </lvc:CartesianChart>
                            <!--Doanh thu từng dịch vụ-->
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="Doanh thu từng dịch vụ:"
                                           FontWeight="Bold"
                                           FontSize="20"
                                           Foreground="{StaticResource btnActivedText}"
                                           Margin="0 30 0 10"/>
                                <ScrollViewer VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Disabled"
                                      MaxHeight="450">
                                    <ListView ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                            ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                            BorderBrush="Transparent" Background="White"
                                            HorizontalAlignment="Stretch"
                                            PreviewMouseWheel="ListView_PreviewMouseWheel"
                                            ItemsSource="{Binding ListDichVu}">
                                        <ListView.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel IsItemsHost="True" Orientation="Vertical" />
                                            </ItemsPanelTemplate>
                                        </ListView.ItemsPanel>
                                        <ListView.ItemContainerStyle>
                                            <Style TargetType="ListViewItem">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                            </Style>
                                        </ListView.ItemContainerStyle>
                                        <ListView.ItemTemplate>
                                            <DataTemplate>
                                                <Border BorderBrush="{StaticResource btnActivedText}"
                                                    BorderThickness="2 0 0 0"
                                                    Margin="0 20 0 0">
                                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Left"
                                                        Margin="10 0 0 0">
                                                        <!--tên dịch vụ-->
                                                        <TextBlock Text="{Binding Ten}"
                                                        Foreground="#3f3f3f"
                                                        FontSize="18"
                                                        FontWeight="Medium"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Center"/>

                                                        <!--doanh thu theo dịch vụ-->
                                                        <TextBlock Text="{Binding Doanhthu}"
                                                        Foreground="#3f3f3f"
                                                        FontSize="16"
                                                        FontWeight="Medium"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                </ScrollViewer>
                            </StackPanel>
                        </Grid>
                        <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="50 0 0 0">
                            <TextBlock Text="Tổng doanh thu: "
                                        FontSize="25"
                                        FontWeight="Bold"/>
                            <!--Tổng doanh = tổng số tiền trong bệnh án vào đây thu dịch vụ trong thời gian được chọn vào đây-->
                            <TextBlock Text="{Binding Service_count}"
                                        FontSize="25"
                                        FontWeight="Bold"/>
                            <TextBlock Text=" VNĐ"
                                        FontSize="25"
                                        FontWeight="Bold"/>
                            <DockPanel Width="600">
                                <Button 
                                HorizontalAlignment="Right"
                                Style="{StaticResource BtnUserControl}" Click="Service_Button_Click"
                                >
                                    <TextBlock
                                    Style="{StaticResource UserControlText}"
                                    Text="Xuất biểu đồ"/>
                                </Button>
                            </DockPanel>
                        </StackPanel>
                    </Grid>
                </TabItem>
            </TabControl>
        </Grid>
    </Border>
</UserControl>
